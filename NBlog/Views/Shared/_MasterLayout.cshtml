@using NBlog.Helpers
@using TJ.Extensions
<!DOCTYPE html>
<html class="no-js">
<head>
    <meta charset="utf-8" />
	<!--[if lt IE 9]>
		<script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
	<![endif]-->

	<!-- Mobile Specific Metas
  ================================================== -->
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

    <title>Tomas Jansson @( ((string)ViewBag.Title).IsNullOrEmpty() ? string.Empty : ": " + @ViewBag.Title)</title>
    <link href="@Url.Content(Links.Content.site_css)" rel="stylesheet" type="text/css" />
    <script src="@Url.Content(Links.Scripts.jquery_1_5_1_min_js)" type="text/javascript"></script>
    <script src="@Url.Content(Links.Scripts.jquery_validate_min_js)" type="text/javascript"></script>
    <script src="@Url.Content(Links.Scripts.jquery_validate_unobtrusive_min_js)" type="text/javascript"></script>
    <script src="@Url.Content(Links.Scripts.modernizr_1_7_js)" type="text/javascript"></script>
    <script src="@Url.Content(Links.Scripts.NBlog_js)" type="text/javascript"></script>
</head>

<body>
    @RenderFlash()
    @Html.Partial("_SuperHeader")
    @RenderBody()
    <footer class="container footer" id="footer">
        <p>Copyright @DateTime.Now.Year @@ Tomas Jansson</p>        
    </footer>
</body>
</html>

@helper RenderFlash()
    {
    var flashMessagesDictionary = TempData.GetFlashMessages() ?? new Dictionary<string, List<string>>();
    var viewDataFlashMessagesDictionary = ViewData.GetFlashMessages();
    foreach (var viewDataFlashMessagesEntry in viewDataFlashMessagesDictionary)
    {
        if (flashMessagesDictionary.ContainsKey(viewDataFlashMessagesEntry.Key))
        {
            flashMessagesDictionary[viewDataFlashMessagesEntry.Key].AddRange(viewDataFlashMessagesEntry.Value);
        }
        else
        {
            flashMessagesDictionary.Add(viewDataFlashMessagesEntry.Key, viewDataFlashMessagesEntry.Value);
        }
    }
    if (flashMessagesDictionary.Count > 0)
    {
        <div class="flash-container">
            @Html.DictionaryToUlLiList(flashMessagesDictionary, "div", "container")
        </div>
    }
}